<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports Module - Warranty Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap">
    <style>
        :root {
            --primary-color: #5b87a4;
            --secondary-color: #2e4154;
            --accent-color: #d35e5e;
            --light-color: #f5f7f9;
            --dark-color: #2c3e50;
            --code-bg: #f8f9fa;
            --border-color: #e9ecef;
            --method-color: #e3f2fd;
            --property-color: #fff3cd;
            --namespace-color: #d1e7dd;
        }
        
        body {
            font-family: 'Source Sans Pro', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: var(--light-color);
        }
        
        .navbar {
            background-color: var(--secondary-color);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .navbar-brand {
            font-weight: bold;
            color: white !important;
        }
        
        .sidebar {
            position: fixed;
            top: 56px;
            left: 0;
            width: 280px;
            height: calc(100vh - 56px);
            background-color: white;
            overflow-y: auto;
            transition: all 0.3s;
            z-index: 1000;
            padding: 0;
            box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
        }
        
        .main-content {
            margin-left: 280px;
            padding: 20px 30px;
            background-color: white;
            min-height: calc(100vh - 56px);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        }
        
        .nav-item {
            border-bottom: 1px solid var(--border-color);
        }
        
        .nav-link {
            color: var(--dark-color);
            padding: 0.8rem 1rem;
            font-size: 0.95rem;
        }
        
        .nav-link:hover {
            background-color: var(--light-color);
        }
        
        .nav-link.active {
            background-color: var(--light-color);
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .nav-link .badge {
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            margin-left: 5px;
        }
        
        .section-title {
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border-color);
        }
        
        .subsection-title {
            color: var(--secondary-color);
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        
        code {
            background-color: var(--code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9em;
            color: var(--accent-color);
        }
        
        pre {
            background-color: var(--code-bg);
            padding: 1rem;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            overflow-x: auto;
        }
        
        .method-container, .property-container {
            margin-bottom: 2rem;
            padding: 1rem;
            border-radius: 5px;
            border: 1px solid var(--border-color);
        }
        
        .method-container {
            background-color: var(--method-color);
        }
        
        .property-container {
            background-color: var(--property-color);
        }
        
        .method-name, .property-name {
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        .method-signature {
            font-family: monospace;
            padding: 0.5rem;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 3px;
            margin: 0.5rem 0;
            overflow-x: auto;
        }
        
        .param-table {
            width: 100%;
            margin: 1rem 0;
        }
        
        .param-table th {
            background-color: rgba(0, 0, 0, 0.05);
            text-align: left;
            padding: 0.5rem;
        }
        
        .param-table td {
            padding: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .param-name {
            font-family: monospace;
            font-weight: 600;
        }
        
        .param-type {
            color: var(--primary-color);
            font-family: monospace;
        }
        
        .return-value {
            margin-top: 1rem;
            padding: 0.5rem;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 3px;
        }
        
        .namespace-badge {
            display: inline-block;
            background-color: var(--namespace-color);
            padding: 0.3rem 0.6rem;
            border-radius: 3px;
            font-size: 0.8rem;
            margin-bottom: 1rem;
        }
        
        .description {
            margin-bottom: 1rem;
        }
        
        .breadcrumb {
            background-color: transparent;
            padding: 0;
            margin-bottom: 1.5rem;
        }
        
        .breadcrumb-item a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        .breadcrumb-item.active {
            color: var(--dark-color);
        }
        
        .toc {
            background-color: var(--light-color);
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 2rem;
        }
        
        .toc-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .toc-list {
            list-style-type: none;
            padding-left: 0;
        }
        
        .toc-list li {
            margin-bottom: 0.5rem;
        }
        
        .toc-list a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        .search-container {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .search-container input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 3px;
        }
        
        .alert-info {
            background-color: #e3f2fd;
            border-color: #b6d4fe;
            color: #0a58ca;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">
                Warranty Management System
            </a>
        </div>
    </nav>

    <div class="sidebar">
        <div class="search-container">
            <input type="text" placeholder="Search documentation..." id="search-input">
        </div>
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link" href="index.html">
                    <i class="fas fa-home me-2"></i> Overview
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="modules.html">
                    <i class="fas fa-cubes me-2"></i> Modules
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="admin_module.html">
                    <i class="fas fa-user-shield me-2"></i> Admin Module
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="claims_module.html">
                    <i class="fas fa-file-alt me-2"></i> Claims Module
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="reports_module.html">
                    <i class="fas fa-chart-bar me-2"></i> Reports Module
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="warranty_rules.html">
                    <i class="fas fa-gavel me-2"></i> Warranty Rules
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="database_schema.html">
                    <i class="fas fa-database me-2"></i> Database Schema
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="api_reference.html">
                    <i class="fas fa-code me-2"></i> API Reference
                </a>
            </li>
        </ul>
    </div>

    <div class="main-content">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item"><a href="modules.html">Modules</a></li>
                <li class="breadcrumb-item active">Reports Module</li>
            </ol>
        </nav>

        <h1 class="section-title">Reports Module</h1>
        
        <div class="namespace-badge">
            <i class="fas fa-folder me-1"></i> WarrantySystem\Reports
        </div>
        
        <div class="description">
            <p>The Reports Module provides analytical reports and data visualization for warranty claims data. It allows users to generate various reports to analyze claim patterns, track performance metrics, and gain insights into warranty service operations.</p>
        </div>
        
        <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i>
            <strong>Important:</strong> Based on system memory, the Reports Module has been updated to include improved DataTable styling, Excel export functionality with proper totals, and monthly breakdown of claims by category.
        </div>
        
        <div class="toc">
            <div class="toc-title">Table of Contents</div>
            <ul class="toc-list">
                <li><a href="#overview">Module Overview</a></li>
                <li><a href="#files">Key Files</a></li>
                <li><a href="#report-types">Report Types</a></li>
                <li><a href="#excel-exports">Excel Export Functionality</a></li>
                <li><a href="#datatable-styling">DataTable Styling</a></li>
                <li><a href="#functions">Core Functions</a></li>
            </ul>
        </div>
        
        <h2 class="subsection-title" id="overview">Module Overview</h2>
        <p>The Reports Module provides a comprehensive set of analytical tools for monitoring and evaluating warranty claim data. It includes various report types that focus on different aspects of the warranty service operation, such as claim performance, product analysis, and category analysis.</p>
        
        <h2 class="subsection-title" id="files">Key Files</h2>
        
        <div class="method-container">
            <div class="method-name">reports.php</div>
            <div class="method-signature">Path: /admin/reports.php</div>
            <div class="description">
                <p>Main file for generating and displaying reports. Handles report generation, filtering, and export functionality.</p>
                <p>This file includes functionality for:</p>
                <ul>
                    <li>Generating different types of reports based on user selection</li>
                    <li>Filtering reports by date range</li>
                    <li>Displaying report data in tables and charts</li>
                    <li>Exporting reports to Excel format</li>
                </ul>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">export_report.php</div>
            <div class="method-signature">Path: /admin/export_report.php</div>
            <div class="description">
                <p>Handles the export of reports to Excel format. Processes export requests and generates Excel files.</p>
            </div>
        </div>
        
        <h2 class="subsection-title" id="report-types">Report Types</h2>
        
        <div class="method-container">
            <div class="method-name">Claim Performance Report</div>
            <div class="description">
                <p>This report shows the overall performance of the warranty claim process, including:</p>
                <ul>
                    <li>Claims by status (new, in_progress, on_hold, approved, rejected)</li>
                    <li>Average resolution time</li>
                    <li>SLA compliance rate</li>
                    <li>Escalated claims (exceeding SLA)</li>
                </ul>
                <p>The report provides insights into the efficiency of the claim resolution process and helps identify bottlenecks or areas for improvement.</p>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">SKU Analysis Report</div>
            <div class="description">
                <p>This report focuses on product-specific claim data, including:</p>
                <ul>
                    <li>Most claimed SKUs</li>
                    <li>Claims by category for each SKU</li>
                    <li>Claim rate by SKU</li>
                </ul>
                <p>The SKU Analysis Report helps identify products with high claim rates or specific issues, allowing for targeted quality improvements or customer service interventions.</p>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">Product Type Analysis</div>
            <div class="description">
                <p>This report analyzes claims by product type, including:</p>
                <ul>
                    <li>Most claimed product types</li>
                    <li>Claims by category for each product type</li>
                </ul>
                <p>The Product Type Analysis provides a broader view of claim patterns across product categories rather than individual SKUs.</p>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">Category Analysis</div>
            <div class="description">
                <p>This report focuses on claim categories, including:</p>
                <ul>
                    <li>Claims by category</li>
                    <li>SLA days for each category</li>
                    <li>Monthly breakdown of claims by category</li>
                </ul>
                <p>The Category Analysis helps identify the most common types of issues reported in warranty claims, allowing for targeted product improvements or customer education.</p>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">Monthly Category Analysis</div>
            <div class="description">
                <p>This report provides a monthly breakdown of claims by category, displayed in a tabular format with:</p>
                <ul>
                    <li>Categories as rows</li>
                    <li>Months as columns</li>
                    <li>Totals for each category and month</li>
                </ul>
                <p>This report helps identify seasonal patterns or trends in different types of warranty claims.</p>
            </div>
        </div>
        
        <h2 class="subsection-title" id="excel-exports">Excel Export Functionality</h2>
        
        <div class="method-container">
            <div class="method-name">Excel Export Features</div>
            <div class="description">
                <p>The Reports Module includes comprehensive Excel export functionality with the following features:</p>
                <ul>
                    <li>Export of any report table to Excel format</li>
                    <li>Inclusion of column totals for numeric columns</li>
                    <li>Proper styling of total rows with light blue background (DDEBF7)</li>
                    <li>Bold text for total rows</li>
                    <li>Center-aligned cells</li>
                    <li>Date range included in the exported filename</li>
                </ul>
                <p>The Excel exports are designed to match the reference format exactly, ensuring consistency with existing reports.</p>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">customizeData</div>
            <div class="method-signature">function customizeData($data)</div>
            <div class="description">
                <p>Customizes the data before Excel generation, calculating totals at the data level.</p>
                <p>This function:</p>
                <ul>
                    <li>Calculates column totals for numeric values</li>
                    <li>Creates a proper footer array with calculated totals</li>
                    <li>Ensures totals are displayed as static values rather than formulas</li>
                </ul>
                
                <div class="return-value">
                    <strong>Returns:</strong> <span class="param-type">array</span> - Modified data array with totals
                </div>
            </div>
        </div>
        
        <h2 class="subsection-title" id="datatable-styling">DataTable Styling</h2>
        
        <div class="method-container">
            <div class="method-name">DataTable Styling Features</div>
            <div class="description">
                <p>The Reports Module includes custom styling for DataTables with the following features:</p>
                <ul>
                    <li>Clean design without hover effects on rows</li>
                    <li>No outer borderlines</li>
                    <li>Improved pagination styling</li>
                    <li>Export button and search box aligned in the same row</li>
                    <li>Total row fixed at the bottom (not included in pagination)</li>
                    <li>Blue background (table-primary) for total rows</li>
                    <li>Bold text (fw-bold) for total rows</li>
                </ul>
                <p>The DataTable styling is applied system-wide through CSS in the header.php file, ensuring consistent styling across all pages.</p>
            </div>
        </div>
        
        <h2 class="subsection-title" id="functions">Core Functions</h2>
        
        <div class="method-container">
            <div class="method-name">generateReport</div>
            <div class="method-signature">function generateReport($reportType, $startDate, $endDate, $userId = null)</div>
            <div class="description">
                <p>Generates a report based on the specified type and date range.</p>
                
                <table class="param-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="param-name">$reportType</td>
                            <td class="param-type">string</td>
                            <td>Type of report to generate (claim_performance, sku_analysis, product_type, category_analysis)</td>
                        </tr>
                        <tr>
                            <td class="param-name">$startDate</td>
                            <td class="param-type">string</td>
                            <td>Start date for the report data (YYYY-MM-DD format)</td>
                        </tr>
                        <tr>
                            <td class="param-name">$endDate</td>
                            <td class="param-type">string</td>
                            <td>End date for the report data (YYYY-MM-DD format)</td>
                        </tr>
                        <tr>
                            <td class="param-name">$userId</td>
                            <td class="param-type">int|null</td>
                            <td>Optional user ID to filter reports by user (for CS Agents)</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="return-value">
                    <strong>Returns:</strong> <span class="param-type">array</span> - Report data
                </div>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">exportToExcel</div>
            <div class="method-signature">function exportToExcel($reportData, $reportType, $startDate, $endDate)</div>
            <div class="description">
                <p>Exports report data to Excel format.</p>
                
                <table class="param-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="param-name">$reportData</td>
                            <td class="param-type">array</td>
                            <td>Report data to export</td>
                        </tr>
                        <tr>
                            <td class="param-name">$reportType</td>
                            <td class="param-type">string</td>
                            <td>Type of report being exported</td>
                        </tr>
                        <tr>
                            <td class="param-name">$startDate</td>
                            <td class="param-type">string</td>
                            <td>Start date of the report data</td>
                        </tr>
                        <tr>
                            <td class="param-name">$endDate</td>
                            <td class="param-type">string</td>
                            <td>End date of the report data</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="return-value">
                    <strong>Returns:</strong> <span class="param-type">void</span> - Outputs Excel file for download
                </div>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">getClaimsByStatus</div>
            <div class="method-signature">function getClaimsByStatus($startDate, $endDate, $userId = null)</div>
            <div class="description">
                <p>Gets the count of claims by status for the specified date range.</p>
                
                <div class="return-value">
                    <strong>Returns:</strong> <span class="param-type">array</span> - Claims by status
                </div>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">getAverageResolutionTime</div>
            <div class="method-signature">function getAverageResolutionTime($startDate, $endDate, $userId = null)</div>
            <div class="description">
                <p>Calculates the average resolution time for claims in the specified date range.</p>
                
                <div class="return-value">
                    <strong>Returns:</strong> <span class="param-type">float</span> - Average resolution time in days
                </div>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">getSLAComplianceRate</div>
            <div class="method-signature">function getSLAComplianceRate($startDate, $endDate, $userId = null)</div>
            <div class="description">
                <p>Calculates the SLA compliance rate for claims in the specified date range.</p>
                
                <div class="return-value">
                    <strong>Returns:</strong> <span class="param-type">float</span> - SLA compliance rate as a percentage
                </div>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">getClaimsByCategory</div>
            <div class="method-signature">function getClaimsByCategory($startDate, $endDate, $userId = null)</div>
            <div class="description">
                <p>Gets the count of claims by category for the specified date range.</p>
                
                <div class="return-value">
                    <strong>Returns:</strong> <span class="param-type">array</span> - Claims by category
                </div>
            </div>
        </div>
        
        <div class="method-container">
            <div class="method-name">getMonthlyCategoryBreakdown</div>
            <div class="method-signature">function getMonthlyCategoryBreakdown($startDate, $endDate, $userId = null)</div>
            <div class="description">
                <p>Gets a monthly breakdown of claims by category for the specified date range.</p>
                
                <div class="return-value">
                    <strong>Returns:</strong> <span class="param-type">array</span> - Monthly breakdown of claims by category
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).ready(function() {
            // Simple search functionality
            $("#search-input").on("keyup", function() {
                var value = $(this).val().toLowerCase();
                $(".nav-link").filter(function() {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });
        });
    </script>
</body>
</html>
